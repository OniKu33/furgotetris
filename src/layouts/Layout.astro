---
import { ViewTransitions } from "astro:transitions";
import "../styles/global.css"; // <--- Â¡AQUÃ ESTÃ LA CLAVE!

const { title } = Astro.props;
const pathname = Astro.url.pathname;

// Detectamos si estamos en modo juego para ocultar el menÃº
const isTetrisMode =
	pathname.includes("/tetris") || pathname.includes("/carga");

// Helper para clases activas
const getLinkClass = (path) => {
	// Truco: si la ruta es exacta o empieza por ella (para subpÃ¡ginas)
	const isActive =
		pathname === path || (path !== "/" && pathname.startsWith(path));

	return isActive
		? "text-yellow-400 bg-slate-700/50 shadow-inner scale-105" // Activo
		: "text-slate-400 hover:text-white hover:bg-slate-700/30"; // Inactivo
};
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
		/>
		<title>{title} | FurgoTetris</title>
		<ViewTransitions />
	</head>
	<body
		class="bg-slate-900 text-white min-h-screen font-sans selection:bg-yellow-500 selection:text-black overflow-x-hidden pb-32"
	>
		<main class="max-w-md mx-auto min-h-screen relative">
			<slot />
		</main>

		{
			!isTetrisMode && (
				<div class="fixed bottom-6 left-0 right-0 z-50 flex justify-center px-4 pointer-events-none">
					<nav class="pointer-events-auto w-full max-w-xs bg-slate-800/90 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl p-2 flex justify-between items-center gap-2">
						<a
							href="/inventario"
							class={`flex-1 flex flex-col items-center justify-center py-3 rounded-xl transition-all duration-200 ${getLinkClass("/inventario")}`}
						>
							<span class="text-xl mb-1">ðŸ“¦</span>
							<span class="text-[10px] font-bold uppercase tracking-wide">
								Items
							</span>
						</a>

						<a
							href="/manifiesto"
							class={`flex-1 flex flex-col items-center justify-center py-3 rounded-xl transition-all duration-200 ${getLinkClass("/plan")}`}
						>
							<span class="text-xl mb-1">ðŸ“‹</span>
							<span class="text-[10px] font-bold uppercase tracking-wide">
								Manifiesto
							</span>
						</a>

						<a
							href="/tetris"
							class="flex items-center justify-center w-14 h-14 bg-gradient-to-br from-green-500 to-emerald-700 text-white rounded-xl shadow-lg border border-white/20 hover:scale-105 active:scale-95 transition-all duration-200"
						>
							<span class="text-2xl filter drop-shadow-md">ðŸš€</span>
						</a>
					</nav>
				</div>
			)
		}
	</body>
</html>
